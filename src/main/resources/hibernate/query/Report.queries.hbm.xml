<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <query name="Report.getCumulatedHoursPerAssignmentOnDateForUserIds">
         <![CDATA[SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.entryDate >= :dateStart AND
                      entry.entryId.entryDate <= :dateEnd AND
                      entry.entryId.projectAssignment.user.userId IN (:userIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
        ]]></query>

    <query name="Report.getCumulatedHoursPerAssignmentForUserIds">
        SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
        FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.user.userId IN (:userIds)
        GROUP BY entry.entryId.projectAssignment.assignmentId
	</query>

    <query name="Report.getCumulatedHoursPerAssignmentForAssignmentIds">
        SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
        FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.assignmentId IN (:assignmentIds)
        GROUP BY entry.entryId.projectAssignment.assignmentId
	</query>

    <query name="Report.getCumulatedHoursPerAssignmentForUserIdsAndProjectIds">
		SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
        FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.user.userId IN (:userIds) AND
        	  entry.entryId.projectAssignment.project.projectId IN (:projectIds)
        GROUP BY entry.entryId.projectAssignment.assignmentId
	</query>

    <query name="Report.getCumulatedHoursPerAssignmentOnDateForUserIdsAndProjectIds">
         <![CDATA[SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.entryDate >= :dateStart AND
                      entry.entryId.entryDate <= :dateEnd AND
                      entry.entryId.projectAssignment.user.userId IN (:userIds) AND
                	  entry.entryId.projectAssignment.project.projectId IN (:projectIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
        ]]></query>
        
    <query name="Report.getCumulatedHoursPerAssignment">
        <![CDATA[
        SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
        FROM TimesheetEntry entry
        WHERE entry.entryId.entryDate >= :dateStart AND
              entry.entryId.entryDate <= :dateEnd 
        GROUP BY entry.entryId.projectAssignment.assignmentId
        ]]>
	</query>        
        
    <query name="Report.getCumulatedHoursPerAssignmentOnDateForProjectIds">
         <![CDATA[SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.entryDate >= :dateStart AND
                      entry.entryId.entryDate <= :dateEnd AND
                	  entry.entryId.projectAssignment.project.projectId IN (:projectIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
        ]]>
	</query>
    
    <query name="Report.getCumulatedHoursForAssignment">
         <![CDATA[SELECT new net.rrm.ehour.report.reports.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.projectAssignment = :assignment
                GROUP BY entry.entryId.projectAssignment.assignmentId                
        ]]>
	</query>
                       
        
    <query name="Report.getMinMaxTimesheetEntryDate">
        SELECT new net.rrm.ehour.data.DateRange(min(entry.entryId.entryDate), max(entry.entryId.entryDate))
		FROM TimesheetEntry entry
	</query>     

    <query name="Report.getMinMaxTimesheetEntryDateForUser">
        SELECT new net.rrm.ehour.data.DateRange(min(entry.entryId.entryDate), max(entry.entryId.entryDate))
		FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.user.userId = :userId
	</query> 

    <query name="Report.getMinMaxTimesheetEntryDateForProject">
        SELECT new net.rrm.ehour.data.DateRange(min(entry.entryId.entryDate), max(entry.entryId.entryDate))
		FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.project = :project
	</query> 

</hibernate-mapping>