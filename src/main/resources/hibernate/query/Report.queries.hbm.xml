<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <query name="Report.getCumulatedHoursPerAssignmentOnDateForUserIds">
         <![CDATA[SELECT new net.rrm.ehour.report.project.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.entryDate >= :dateStart AND
                      entry.entryId.entryDate <= :dateEnd AND
                      entry.entryId.projectAssignment.user.userId IN (:userIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
				ORDER BY entry.entryId.projectAssignment.project.projectCode
        ]]></query>

    <query name="Report.getCumulatedHoursPerAssignmentForUserIds">
         <![CDATA[SELECT new net.rrm.ehour.report.project.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.projectAssignment.user.userId IN (:userIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
				ORDER BY entry.entryId.projectAssignment.project.projectCode
        ]]></query>

    <query name="Report.getCumulatedHoursPerAssignmentForUserIdsAndProjectIds">
         <![CDATA[SELECT new net.rrm.ehour.report.project.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.projectAssignment.user.userId IN (:userIds) AND
                	  entry.entryId.projectAssignment.project.projectId IN (:projectIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
				ORDER BY entry.entryId.projectAssignment.project.projectCode
        ]]></query>

    <query name="Report.getCumulatedHoursPerAssignmentOnDateForUserIdsAndProjectIds">
         <![CDATA[SELECT new net.rrm.ehour.report.project.ProjectAssignmentAggregate(entry.entryId.projectAssignment, SUM(entry.hours), SUM(entry.hours) * entry.entryId.projectAssignment.hourlyRate)
                FROM TimesheetEntry entry
                WHERE entry.entryId.entryDate >= :dateStart AND
                      entry.entryId.entryDate <= :dateEnd AND
                      entry.entryId.projectAssignment.user.userId IN (:userIds) AND
                	  entry.entryId.projectAssignment.project.projectId IN (:projectIds)
                GROUP BY entry.entryId.projectAssignment.assignmentId
				ORDER BY entry.entryId.projectAssignment.project.projectCode
        ]]></query>
        
    <query name="Report.getMinMaxTimesheetEntryDate">
        SELECT new net.rrm.ehour.data.DateRange(min(entry.entryId.entryDate), max(entry.entryId.entryDate))
		FROM TimesheetEntry entry
	</query>     

    <query name="Report.getMinMaxTimesheetEntryDateForUser">
        SELECT new net.rrm.ehour.data.DateRange(min(entry.entryId.entryDate), max(entry.entryId.entryDate))
		FROM TimesheetEntry entry
        WHERE entry.entryId.projectAssignment.user.userId = :userId
	</query> 	
	<query name="Report.getAvailReportCriteria">
	   	SELECT new net.rrm.ehour.user.domain.User(user.userId, user.firstName, user.lastName)
	   	FROM User user
	</query>
</hibernate-mapping>