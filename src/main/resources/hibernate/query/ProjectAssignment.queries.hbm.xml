<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<query name="ProjectAssignment.findProjectAssignmentsForUserForProject">
		FROM ProjectAssignment pa
		WHERE pa.project.active is true AND
			  pa.project.projectId = :projectId AND
			  pa.user.userId = :userId
	</query>	

	<query name="ProjectAssignment.findProjectAssignmentsForUser">
		FROM ProjectAssignment pa
		WHERE pa.project.active is true AND
			  pa.project.customer.active is true AND 
			  pa.user.userId = :userId
		ORDER BY pa.dateStart, pa.project.name
	</query>	

	<query name="ProjectAssignment.findProjectsForUserForType">
		FROM ProjectAssignment pa
		WHERE pa.project.active is true AND
			  pa.project.customer.active is true AND 
			  pa.user.userId = :userId AND
			  pa.assignmentType = :type
		ORDER BY pa.dateStart, pa.project.name
	</query>	

	<query name="ProjectAssignment.findProjectAssignmentsForUserInRange">
    <![CDATA[	
		FROM ProjectAssignment pa
		WHERE pa.active is true AND 
			  pa.project.active is true AND
			  pa.project.customer.active is true AND 
			  pa.user.userId = :userId AND
			  ((pa.assignmentType = '0' AND pa.dateStart <= :dateEnd AND pa.dateEnd >= :dateStart) OR
			   pa.assignmentType = '1' OR
			   (pa.assignmentType = '2' AND (pa.dateStart IS NULL OR pa.dateStart <= :dateEnd) AND 
			   								 (pa.dateEnd IS NULL or pa.dateEnd >= :dateEnd))
			   )
    		 ]]>
	</query>	
</hibernate-mapping>