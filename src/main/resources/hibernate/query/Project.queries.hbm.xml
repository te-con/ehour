<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<query name="Customer.findAllWithActive">
		FROM Customer customer
	    WHERE active = :active
	</query>
	
	<query name="Project.findAllActive">
		FROM Project project
		WHERE project.active is true AND
			  project.customer.active is true
	    ORDER BY name
	</query>	
	
	<query name="Project.findAllActiveDefault">
		FROM Project project
	    WHERE active is true AND 
	    	  project.customer.active is true AND 
	    	  defaultProject is true
	</query>	
	
	<query name="ProjectAssignment.findProjectForUser">
		FROM ProjectAssignment pa
		WHERE pa.project.active is true AND
			  pa.project.projectId = :projectId AND
			  pa.user.userId = :userId
	</query>	

	<query name="ProjectAssignment.findProjectsForUser">
		FROM ProjectAssignment pa
		WHERE pa.project.active is true AND
			  pa.project.customer.active is true AND 
			  pa.user.userId = :userId
		ORDER BY pa.dateStart, pa.project.name
	</query>	

	<query name="ProjectAssignment.findProjectsForUserInRange">
    <![CDATA[	
		FROM ProjectAssignment pa
		WHERE pa.active is true AND 
			  pa.project.active is true AND
			  pa.project.customer.active is true AND 
			  pa.user.userId = :userId AND
			  (pa.defaultAssignment is true OR (pa.dateStart <= :dateEnd AND pa.dateEnd >= :dateStart))
    		 ]]>
	</query>	


</hibernate-mapping>